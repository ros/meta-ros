header:
  version: 14

repos:
  clang:
    url: "https://github.com/kraj/meta-clang.git"
    path: "layers/meta-clang"

  qt5:
    url: "https://github.com/meta-qt5/meta-qt5.git"
    path: "layers/meta-qt5"

local_conf_header:
  world: |
    DISTRO_FEATURES:append = " x11 opengl vulkan polkit glvnd"
    PACKAGECONFIG:append:pn-clang = "  libomp"
    PACKAGECONFIG:append:pn-qtbase-native = " gui"
    PACKAGECONFIG:append:pn-python3 = "  tk"
    PACKAGECONFIG:append:pn-mesa = " glvnd "
    LICENSE_FLAGS_ACCEPTED += "commercial"

    # This is copied from default-providers.inc in oe-core
    # It is being duplicated in local.conf to avoid being
    # incorrectly overridden by in meta-raspberrypi
    PREFERRED_PROVIDER_virtual/egl ?= "${@bb.utils.contains('DISTRO_FEATURES','glvnd','libglvnd','mesa',d)}"
    PREFERRED_PROVIDER_virtual/libgl ?= "${@bb.utils.contains('DISTRO_FEATURES', 'glvnd', 'libglvnd', 'mesa',d)}"
    PREFERRED_PROVIDER_virtual/libgl-native ?= "${@bb.utils.contains('DISTRO_FEATURES', 'glvnd', 'libglvnd-native', 'mesa-native',d)}"
    PREFERRED_PROVIDER_virtual/nativesdk-libgl ?= "${@bb.utils.contains('DISTRO_FEATURES', 'glvnd', 'nativesdk-libglvnd', 'nativesdk-mesa',d)}"
    PREFERRED_PROVIDER_virtual/libgles1 ?= "${@bb.utils.contains('DISTRO_FEATURES', 'glvnd', 'libglvnd', 'mesa',d)}"
    PREFERRED_PROVIDER_virtual/libgles2 ?= "${@bb.utils.contains('DISTRO_FEATURES', 'glvnd', 'libglvnd', 'mesa',d)}"
    PREFERRED_PROVIDER_virtual/libgles3 ?= "${@bb.utils.contains('DISTRO_FEATURES', 'glvnd', 'libglvnd', 'mesa',d)}"
