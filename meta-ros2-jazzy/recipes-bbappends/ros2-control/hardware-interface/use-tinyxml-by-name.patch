From 9a9c55199eb65c97f6b788f84be0219ce14b547f Mon Sep 17 00:00:00 2001
From: Rob Woolley <rob.woolley@windriver.com>
Date: Thu, 28 Aug 2025 07:48:11 -0700
Subject: [PATCH] Use pkg-config to find TinyXML2

This helps avoid absolute paths from being injected into the
generated cmake files.

Upstream-Status: Pending

Signed-off-by: Rob Woolley <rob.woolley@windriver.com>
---
 CMakeLists.txt | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

diff --git a/CMakeLists.txt b/CMakeLists.txt
index e10f7ec16..b250e3ecb 100644
--- a/CMakeLists.txt
+++ b/CMakeLists.txt
@@ -13,8 +13,6 @@ set(THIS_PACKAGE_INCLUDE_DEPENDS
   rcpputils
   rcutils
   realtime_tools
-  TinyXML2
-  tinyxml2_vendor
   joint_limits
   urdf
   pal_statistics
@@ -24,6 +22,10 @@ set(THIS_PACKAGE_INCLUDE_DEPENDS
 find_package(ament_cmake REQUIRED)
 find_package(ament_cmake_gen_version_h REQUIRED)
 find_package(backward_ros REQUIRED)
+
+find_package(PkgConfig REQUIRED)
+pkg_check_modules(tinyxml REQUIRED tinyxml2)
+
 foreach(Dependency IN ITEMS ${THIS_PACKAGE_INCLUDE_DEPENDS})
   find_package(${Dependency} REQUIRED)
 endforeach()
@@ -48,9 +50,8 @@ target_link_libraries(hardware_interface PUBLIC
                       realtime_tools::realtime_tools
                       rcutils::rcutils
                       rcpputils::rcpputils
+                      tinyxml2
                       ${joint_limits_TARGETS}
-                      ${TinyXML2_LIBRARIES}
-                      ${tinyxml2_vendor_LIBRARIES}
                       ${pal_statistics_LIBRARIES}
                       ${control_msgs_TARGETS}
                       ${lifecycle_msgs_TARGETS}
